{"version":3,"sources":["../../src/test/install.js"],"names":["fs","require","test","niv","clean","install","then","packageJson","readFileSync","t","equal","JSON","parse","version","end","err","error","destination","packageJson1","packageJson2","overwrite"],"mappings":"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","file":"install.js","sourcesContent":["const fs = require('fs');\nconst test = require('tape');\n\nconst niv = require('../index.js');\nconst { clean } = require('./test-util.js');\n\n// TODO: Test cleanup & test dependencies\n\ntest('niv.install normal', t => {\n  clean();\n\n  niv.install('csjs@1.0.0').then(() => {\n    const packageJson = fs.readFileSync('niv_modules/csjs@1.0.0/package.json');\n    t.equal(JSON.parse(packageJson).version, '1.0.0');\n    t.end();\n  }, function(err) {\n    t.end(err);\n  })\n});\n\ntest('niv.install remote', t => {\n  clean();\n\n  niv.install('scott113341/csjs#extract-extends-performance').then(() => {\n    const packageJson = fs.readFileSync('niv_modules/scott113341-csjs#extract-extends-performance/package.json');\n    t.equal(JSON.parse(packageJson).version, '1.0.4');\n    t.end();\n  }, error => t.end(error));\n});\n\ntest('niv.install scoped', t => {\n  clean();\n\n  niv.install('@scott113341/niv-scoped-test@1.0.0').then(() => {\n    const packageJson = fs.readFileSync('niv_modules/@scott113341-niv-scoped-test@1.0.0/package.json');\n    t.equal(JSON.parse(packageJson).version, '1.0.0');\n    t.end();\n  }, error => t.end(error));\n});\n\ntest('niv.install w/ dependencies', t => {\n  clean();\n\n  niv.install('push-dir@0.2.2').then(() => {\n    const packageJson = fs.readFileSync('niv_modules/push-dir@0.2.2/package.json');\n    t.equal(JSON.parse(packageJson).version, '0.2.2');\n    t.end();\n  }, error => t.end(error));\n});\n\ntest('niv.install w/ destination', t => {\n  clean();\n\n  niv.install('csjs@1.0.0', { destination: 'csjs@yolo' }).then(() => {\n    const packageJson = fs.readFileSync('niv_modules/csjs@yolo/package.json');\n    t.equal(JSON.parse(packageJson).version, '1.0.0');\n    t.end();\n  }, error => t.end(error));\n});\n\ntest('niv.install w/o overwrite', t => {\n  clean();\n\n  niv.install('csjs@1.0.0', { destination: 'csjs@yolo' })\n    .then(() => {\n      const packageJson1 = fs.readFileSync('niv_modules/csjs@yolo/package.json');\n      t.equal(JSON.parse(packageJson1).version, '1.0.0');\n    })\n    .then(() => niv.install('csjs@1.0.1', { destination: 'csjs@yolo' }))\n    .then(() => {\n      const packageJson2 = fs.readFileSync('niv_modules/csjs@yolo/package.json');\n      t.equal(JSON.parse(packageJson2).version, '1.0.0');\n      t.end();\n    }, error => t.end(error));\n});\n\ntest('niv.install w/ overwrite', t => {\n  clean();\n\n  niv.install('csjs@1.0.0', { destination: 'csjs@yolo' })\n    .then(() => {\n      const packageJson1 = fs.readFileSync('niv_modules/csjs@yolo/package.json');\n      t.equal(JSON.parse(packageJson1).version, '1.0.0');\n    })\n    .then(() => niv.install('csjs@1.0.1', { destination: 'csjs@yolo', overwrite: true }))\n    .then(() => {\n      const packageJson2 = fs.readFileSync('niv_modules/csjs@yolo/package.json');\n      t.equal(JSON.parse(packageJson2).version, '1.0.1');\n      t.end();\n    }, error => t.end(error));\n});\n"]}